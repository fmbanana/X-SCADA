if(jQuery)(function($){'use strict';var modal;var overlay;var okButton;var cancelButton;var activeElement;function show(type,message,options){var defer=$.Deferred();activeElement=document.activeElement;activeElement.blur();$(modal).add(overlay).remove();options=$.extend({},$.messagebox.defaults,options);modal=$(options.modal).hide();overlay=$(options.overlay).hide();okButton=$(options.okButton);cancelButton=$(options.cancelButton);if(options.html){modal.find('.messagebox-message').html(message);}else{modal.find('.messagebox-message').text(message);}
if(type==='prompt'){modal.find('.messagebox-prompt').html(options.prompt);}else{modal.find('.messagebox-prompt').remove();}
$(modal).find('.messagebox-buttons').append(type==='alert'?'':cancelButton).append(okButton);$(options.container).append(overlay).append(modal);options.show.call({modal:modal,overlay:overlay});if(type==='prompt'){$(modal).find('.messagebox-prompt :input:first').focus();}else{$(modal).find(':input[type="submit"]').focus();}
$(modal).on('submit.messagebox',function(event){var i;var formData;var values=[];event.preventDefault();if(type==='prompt'){formData=$(modal).serializeArray();for(i=0;i<formData.length;i++){values[formData[i].name]=formData[i].value;}}else{values=null;}
hide(options);defer.resolve(values);});cancelButton.on('click.messagebox',function(){hide(options);defer.reject();});$(document).on('keydown.messagebox',function(event){if(event.keyCode===27){event.preventDefault();hide(options);defer.reject();}});$(document).on('focus.messagebox','*',function(event){if(!$(event.target).parents().is('.messagebox')){event.stopPropagation();event.target.blur();$(modal).find(':input:first').focus();}});return defer.promise();}
function hide(options){options.hide.call({modal:modal,overlay:overlay});$(document).off('.messagebox');modal.off('.messagebox');cancelButton.off('.messagebox');activeElement.focus();}
$.messagebox={alert:function(message,options){return show('alert',message,options);},confirm:function(message,options){return show('confirm',message,options);},prompt:function(message,options){return show('prompt',message,options);},defaults:{container:'body',html:false,cancelButton:'<button class="messagebox-cancel" type="button">Cancel</button>',okButton:'<button class="messagebox-ok" type="submit">OK</button>',overlay:'<div class="messagebox-overlay"></div>',prompt:'<input class="messagebox-input" type="text" name="value">',modal:'<form class="messagebox">'+'<div class="messagebox-message"></div>'+'<div class="messagebox-prompt"></div>'+'<div class="messagebox-buttons"></div>'+'</form>',hide:function(){$(this.modal).add(this.overlay).fadeOut(100);},show:function(){$(this.modal).add(this.overlay).fadeIn(100);}}};})(jQuery);